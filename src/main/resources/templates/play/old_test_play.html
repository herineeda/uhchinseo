<!DOCTYPE html>
<html lang="kr" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="utf-8" />
    <meta name="description" content="어색한 친구를 소개합니다." />
    <meta name="author" content="번개탄소년단" />
    <title>어친소</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="/css/styles.css" rel="stylesheet" />
    <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>

<th:block th:replace="layout/header" :: topbarFragment></th:block>


            <!-- Masthead-->
            <header class="masthead">
                <div class="container">
					<div class="masthead-heading-2-score text-uppercase"><span style="color:red;">score</span> : 38 </div>
                    <div class="masthead-heading-1 text-uppercase">보자마자 바로 생각나는 노래를 골라라!!</div>
                </div>
            </header>

            <!-- 게임 화면 -->
            <section class="page-section bg-dark" style="padding-top:0rem;">
                <div class="container">
                    <div class="text-center">
						<div class="row">
							<div class="text-center">
								<div class="col-lg-5 mx-auto question" style="background-color: darkseagreen; margin-bottom: 3rem; padding:2rem; font-size: 3rem; word-break: keep-all;" >
									외톨이 하면 생각나는 노래는?</div>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-6" style="padding-top:2.5rem; padding-bottom: 2.5rem; font-size: 2rem; "><div class="answer">
								<button class="first bttn primary">선택지1</button></div></div>
							<div class="col-lg-6" style="padding-top:2.5rem; padding-bottom: 2.5rem; font-size: 2rem;"><div class="answer">
								<button class="second bttn primary">선택지2</button></div></div>
						</div>
						<div class="row">
								<div class="next-text" style="padding-top:2.5rem; padding-bottom: 2.5rem;" >
									<button id="show_answer"> ▶ 정답 보기</button></div>
								<!-- 정답보기 버튼 클릭하면 정답보기 버튼 없어지고 다음으로 넘어가는 버튼 보이게 하기 -->
								<div class="next-text" style="padding-top:2.5rem; padding-bottom: 2.5rem;" >
									<button id="show_next"> ▶ next </button></div>
								<!-- 지금 문제가 마지막 문제인 경우 정답보기 버튼 클릭하면 정답보기 버튼 없어지고 결과 보는 버튼 보이게 하기 -->
								<div class="next-text" style="padding-top:2.5rem; padding-bottom: 2.5rem;" >
									<a href="/agGameResult" style="text-decoration:none;" id="show_result"> ▶ result </a></div>
							</div>
                	</div>
                </div>
                <table>
                    <tr th:each="azGame : ${azGameList}" style="display: none">
                        <td class="invisible-but-need" th:text="${azGame.question} +'/'+${azGame.selection} +'/'+${azGame.answer}+'/'" style="display: none"></td>
                    </tr>
                </table>
            </section>

            <!-- Footer-->
            <footer class="footer py-2 fixed-bottom">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-lg-12 text-shadow" style="color: #FFF; font-size: 1.24rem;">Copyright &copy; TINGTINGTAENGTAENG</div>
                    </div>
                </div>
            </footer>
            
            <!-- Bootstrap core JS-->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
            <!-- Core theme JS-->
            <script src="/js/name.js"></script>
        </div>
        <script th:inline="javascript">
            const answerList = [];  // A , B  아재력 정도 (점수화를 어떻게 할것인지?)
            const questionList = [];    // 문제
            const selectionList = [];   // 선택지
            const categoryList =[]; // 카테고리 번호
            let pageNum = 1 ;


            let f_arr =[];
            let s_arr1;
            let s_arr2;
            let answer_arr = [];

            /*<![CDATA[*/

            /*[# th:each="azGame : ${azGameList}"]*/
            answerList.push(/*[[${azGame.answer}]]*/);
            questionList.push(/*[[${azGame.question}]]*/);
            selectionList.push(/*[[${azGame.selection}]]*/);
            categoryList.push(/*[[${azGame.category}]]*/);
            /*[/]*/

            /*]]>*/
            console.log(answerList);
            console.log(questionList);
            console.log(selectionList);
            console.log(categoryList);


            document.querySelector('.first').innerHTML = selectionList[0];
            document.querySelector('.second').innerHTML = selectionList[1];


            answer_arr[0] = answerList[0];
            answer_arr[1] = answerList[1];
            console.log(answer_arr);

            // 문제
            question = document.querySelector('.question');
            question.innerHTML=questionList[0];


            // next버튼 눌렀을 때 api재 호출하기 (pageNum +1 해서)
            let next_btn;
            next_btn = document.getElementById('next-text');
            next_btn.addEventListener('click', function(){
                console.log('버튼 클릭!');
                pageNum += 1;

                if (pageNum==10){
                    document.getElementById('show_result').style.display ='block';
                    next_btn.style.display='none';
                }
                console.log(pageNum)
                fetch(`http://localhost:8081/azGame?pageNum=${pageNum}`)
                    .then(res => res.text())
                    .then(res => {
                        console.log(res)
                        f_arr = res.split("<td class=\"invisible-but-need\" style=\"display: none\">")
                        console.log(f_arr)

                        s_arr1 = f_arr[1].split('/');
                        s_arr2 = f_arr[2].split('/');

                        // 정답 배열로 저장
                        answer_arr[0] = s_arr1[1];
                        answer_arr[1] = s_arr2[1];

                        document.querySelector('.first').innerHTML = s_arr1[1];
                        document.querySelector('.second').innerHTML = s_arr2[1];

                        console.log(answer_arr);
                        console.log(s_arr1, s_arr1[2]);
                        question.innerHTML=s_arr1[0];
                    });
            });

            let answer_btn;
            answer_btn = document.getElementById('show_answer');
            answer_btn.addEventListener('click',function (){

            });

        </script>
    </body>
</html>
